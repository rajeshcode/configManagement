<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="configuration.xsl"?>

<!-- Put site-specific property overrides in this file. -->

<configuration xmlns:xi="http://www.w3.org/2001/XInclude">

<!-- i/o properties -->

  <property>
    <name>io.sort.mb</name>
    <!--TODO data gen -->
    <value>512</value>
    <description>No description</description>
  </property>

  <property>
    <name>io.sort.spill.percent</name>
    <value>0.9</value>
    <description>No description</description>
  </property>

  <property>
    <name>io.sort.record.percent</name>
    <value>0.15</value>
  </property>

  <property>
    <name>io.sort.factor</name>
    <value>100</value>
    <description>No description</description>
  </property>

<!-- map/reduce properties -->

  <property>
    <name>mapreduce.framework.name</name>
    <value>yarn</value>
  </property>
  
  <property>
    <name>yarn.app.mapreduce.am.staging-dir</name>
    <value>/user/</value>
  </property>

  <property>
    <name>mapred.system.dir</name>
    <value>/mapred/system</value>
    <description>No description</description>
    <final>true</final>
  </property>

  <property>
    <name>mapred.reduce.parallel.copies</name>
    <value>36</value>
    <description>No description</description>
  </property>

  <property>
    <name>mapred.reduce.tasks</name>
    <value>1</value>
  </property>

  <property>
    <name>mapred.map.tasks.speculative.execution</name>
    <value>true</value>
    <description>If true, then multiple instances of some map tasks
               may be executed in parallel.</description>
  </property>

  <property>
    <name>mapred.reduce.tasks.speculative.execution</name>
    <value>false</value>
    <description>If true, then multiple instances of some reduce tasks
               may be executed in parallel.</description>
  </property>


  <property>
    <name>mapred.inmem.merge.threshold</name>
    <value>0</value>
    <description>The threshold, in terms of the number of files
  for the in-memory merge process. When we accumulate threshold number of files
  we initiate the in-memory merge and spill to disk. A value of 0 or less than
  0 indicates we want to DON'T have any threshold and instead depend only on
  the ramfs's memory consumption to trigger the merge.
  </description>
  </property>

  <property>
    <name>mapred.job.shuffle.merge.percent</name>
    <value>0.66</value>
    <description>The usage threshold at which an in-memory merge will be
  initiated, expressed as a percentage of the total memory allocated to
  storing in-memory map outputs, as defined by
  mapred.job.shuffle.input.buffer.percent.
  </description>
  </property>

  <property>
    <name>mapred.job.shuffle.input.buffer.percent</name>
    <value>0.5</value>
    <description>The percentage of memory to be allocated from the maximum heap
  size to storing map outputs during the shuffle.
  </description>
  </property>

  <property>
    <name>mapred.map.output.compression.codec</name>
    <value>com.hadoop.compression.lzo.LzoCodec</value>
    <description>What compression algorithm to use?</description>
  </property>

  <property>
    <name>mapred.output.compression.codec</name>
    <value>org.apache.hadoop.io.compress.GzipCodec</value>
    <description>If the job outputs are compressed, how should they be compressed?</description>
  </property>

<property>
  <name>mapred.output.compression.type</name>
  <value>BLOCK</value>
  <description>If the job outputs are to compressed as SequenceFiles, how should
               they be compressed? Should be one of NONE, RECORD or BLOCK.
  </description>
</property>


  <property>
    <name>mapred.jobtracker.completeuserjobs.maximum</name>
    <value>0</value>
  </property>

  <property>
    <name>mapred.job.reduce.input.buffer.percent</name>
    <!-- TODO Data generation -->
    <!--value>0</value-->
    <value>0.2</value>
    <description>The percentage of memory- relative to the maximum heap size- to
  retain map outputs during the reduce. When the shuffle is concluded, any
  remaining map outputs in memory must consume less than this threshold before
  the reduce can begin.
  </description>
  </property>

 <property>
  <name>mapreduce.reduce.input.limit</name>
  <value>-1</value>
  <description>The limit on the input size of the reduce. (This value
  is 10 Gb.)  If the estimated input size of the reduce is greater than
  this value, job is failed. A value of -1 means that there is no limit
  set. </description>
</property>


  <!-- copied from kryptonite configuration -->
  <property>
    <name>mapred.compress.map.output</name>
    <value>true</value>
  </property>


  <property>
    <name>mapred.task.timeout</name>
    <value>600000</value>
    <description>The number of milliseconds before a task will be
  terminated if it neither reads an input, writes an output, nor
  updates its status string.
  </description>
  </property>

  <property>
    <name>mapred.child.root.logger</name>
    <value>INFO,TLA</value>
   <!-- FIX THIS -->
  </property>

  <property>
    <name>mapreduce.map.env</name>
    <value>LD_LIBRARY_PATH=/home/gs/sid/hadoopCurrent/lib/native</value>
  </property>
  <property>
    <name>mapreduce.reduce.env</name>
    <value>LD_LIBRARY_PATH=/home/gs/sid/hadoopCurrent/lib/native</value>
  </property>

  <property>
    <name>mapreduce.map.java.opts</name>
    <value>-server -Xmx1024m -Djava.net.preferIPv4Stack=true</value>
    <description>No description</description>
  </property>

  <property>
    <name>mapreduce.reduce.java.opts</name>
    <value>-server -Xmx3072m -Djava.net.preferIPv4Stack=true</value>
    <description>No description</description>
  </property>

  <property>
    <name>mapreduce.map.memory.mb</name>
    <value>2048</value>
  </property>

  <property>
    <name>mapreduce.reduce.memory.mb</name>
    <value>4096</value>
  </property>

<property>
  <name>mapred.healthChecker.interval</name>
  <value>135000</value>
</property>

<property>
  <name>mapred.healthChecker.script.timeout</name>
  <value>60000</value>
</property>

<property>
  <name>mapred.jobtracker.retirejob.interval</name>
  <value>0</value>
</property>

  <property> 
    <name>mapreduce.jobhistory.intermediate-done-dir</name> 
    <value>/mapred/history/done_intermediate</value> 
  </property>
  
  <property> 
    <name>mapreduce.jobhistory.done-dir</name> 
    <value>/mapred/history/done</value>
  </property>

  <property>
    <name>mapreduce.fileoutputcommitter.marksuccessfuljobs</name>
    <value>false</value>
  </property>
  
  <property>
    <name>mapreduce.reduce.maxattempts</name>
    <value>4</value>
  </property>

  <property>
    <name>mapreduce.map.maxattempts</name>
    <value>4</value>
  </property>

  <property>
    <name>yarn.app.mapreduce.am.class</name>
    <value>org.apache.hadoop.mapreduce.v2.app2.MRAppMaster</value>
  </property>

  <property>
    <name>mapreduce.jobhistory.address</name>
    <value>apollo-phx-jt.vip.ebay.com:10020</value>
  </property>
  
 <property>
    <name>mapreduce.job.userhistorylocation</name>
    <value>none</value>
 </property>

 <property>
    <name>mapreduce.jobtracker.jobhistory.completed.location</name>
    <value>/jthistory</value>
 </property>
 
  <property>
    <name>mapreduce.job.reduce.slowstart.completedmaps</name>
    <value>0.99</value>
  </property>

  <property>
    <name>yarn.app.mapreduce.am.job.reduce.rampup.limit</name>
    <value>0</value>
  </property>

  <property>
    <name>mapreduce.job.counters.max</name>
    <value>1200</value>
  </property>

  <property>
    <name>yarn.app.mapreduce.command-opts</name>
    <value>-Xmx2048m</value>
  </property>

  <property>
    <name>yarn.app.mapreduce.resource.mb</name>
    <value>2560</value>
  </property>
  <property>
    <name>mapreduce.jobhistory.keytab</name>
    <value>/etc/hadoop/hadoop.keytab</value>
    <final>true</final>
  </property>
  <property>
    <name>mapreduce.jobhistory.principal</name>
    <value>hadoop/hera-phx-jt.vip.ebay.com@APD.EBAY.COM</value>
    <final>true</final>
  </property>
  <property>
    <name>mapreduce.jobhistory.http.policy</name>
    <value>HTTPS_ONLY</value>
    <final>true</final>
  </property>
  <property>
    <name>mapreduce.jobhistory.webapp.https.address</name>
    <value>apollo-phx-jt.vip.ebay.com:51111</value>
    <final>true</final>
  </property>
</configuration>
